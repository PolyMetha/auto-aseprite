- name: Create Release (API)
  id: create_release
  env:
    TAG: ${{ steps.get_version.outputs.version }}
    GH_TOKEN: ${{ secrets.RELEASE_TOKEN }}
  run: |
    $body = @{
      tag_name = $env:TAG
      name     = "Aseprite-Windows-x64-$($env:TAG)"
      draft    = $false
      prerelease = $false
    } | ConvertTo-Json

    $response = Invoke-RestMethod `
      -Uri "https://api.github.com/repos/${{ github.repository }}/releases" `
      -Method POST `
      -Headers @{ Authorization = "Bearer $env:GH_TOKEN"; "Accept" = "application/vnd.github+json" } `
      -Body $body

    echo "release_id=$($response.id)" >> $env:GITHUB_OUTPUT
